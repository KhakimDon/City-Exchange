{% extends "admin/login.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<style>
    /* Устанавливаем primary color #26A17B для Unfold */
    :root {
        --primary-color: #26A17B !important;
        --primary-hover: #1d7a5d !important;
        --primary-light: rgba(38, 161, 123, 0.1) !important;
    }
    
    /* Светлая тема - белый фон и темный текст */
    [data-theme="light"] .login-page,
    html[data-theme="light"] .login-page,
    html:not([data-theme="dark"]) .login-page {
        background: white !important;
    }
    
    /* Светлая тема - черные лейблы */
    [data-theme="light"] .login-page label,
    html[data-theme="light"] .login-page label,
    html:not([data-theme="dark"]) .login-page label,
    [data-theme="light"] .login-page .form-group label,
    html[data-theme="light"] .login-page .form-group label,
    html:not([data-theme="dark"]) .login-page .form-group label {
        color: #000 !important;
        color: black !important;
    }
    
    /* Светлая тема - черный текст в инпутах */
    [data-theme="light"] .login-page .form-control,
    html[data-theme="light"] .login-page .form-control,
    html:not([data-theme="dark"]) .login-page .form-control,
    [data-theme="light"] .login-page input[type="text"],
    [data-theme="light"] .login-page input[type="password"],
    [data-theme="light"] .login-page input[type="email"],
    html[data-theme="light"] .login-page input[type="text"],
    html[data-theme="light"] .login-page input[type="password"],
    html[data-theme="light"] .login-page input[type="email"] {
        background-color: white !important;
        border: 1px solid #ddd !important;
        color: #000 !important;
        color: black !important;
    }
    
    [data-theme="light"] .login-page .form-control:focus,
    html[data-theme="light"] .login-page .form-control:focus,
    html:not([data-theme="dark"]) .login-page .form-control:focus,
    [data-theme="light"] .login-page input[type="text"]:focus,
    [data-theme="light"] .login-page input[type="password"]:focus,
    [data-theme="light"] .login-page input[type="email"]:focus {
        background-color: white !important;
        border-color: #26A17B !important;
        color: #000 !important;
        color: black !important;
        box-shadow: 0 0 0 3px rgba(38, 161, 123, 0.1) !important;
    }
    
    [data-theme="light"] .login-page .form-control::placeholder,
    html[data-theme="light"] .login-page .form-control::placeholder,
    html:not([data-theme="dark"]) .login-page .form-control::placeholder {
        color: rgba(0, 0, 0, 0.5) !important;
    }
    
    [data-theme="light"] .login-page h1,
    [data-theme="light"] .login-page h2,
    [data-theme="light"] .login-page h3,
    [data-theme="light"] .login-page p,
    html[data-theme="light"] .login-page h1,
    html[data-theme="light"] .login-page h2,
    html[data-theme="light"] .login-page h3,
    html[data-theme="light"] .login-page p,
    html:not([data-theme="dark"]) .login-page h1,
    html:not([data-theme="dark"]) .login-page h2,
    html:not([data-theme="dark"]) .login-page h3,
    html:not([data-theme="dark"]) .login-page p {
        color: #333 !important;
    }
    
    /* Применяем primary color ко всем элементам Unfold */
    [data-theme="light"] [data-unfold],
    [data-theme="dark"] [data-unfold],
    .unfold-primary,
    .btn-primary,
    .button-primary,
    input[type="submit"].default,
    .submit-row input[type="submit"],
    .text-primary,
    .text-primary-500 {
        color: #26A17B !important;
    }
    
    /* Заменяем ВСЕ фиолетовые и розовые цвета на #26A17B */
    *[style*="purple"],
    *[style*="violet"],
    *[style*="#667eea"],
    *[style*="#764ba2"],
    *[style*="#6f42c1"],
    *[style*="#7c3aed"],
    *[style*="#8b5cf6"],
    *[style*="#9333ea"],
    *[style*="#a855f7"],
    *[style*="#c084fc"],
    *[style*="#d946ef"],
    *[style*="#ec4899"],
    *[style*="#f472b6"],
    *[style*="rgb(102, 126, 234)"],
    *[style*="rgb(118, 75, 162)"],
    *[style*="rgb(139, 92, 246)"],
    *[style*="rgb(147, 51, 234)"],
    *[style*="rgb(168, 85, 247)"],
    *[style*="rgb(192, 132, 252)"],
    *[style*="rgb(217, 70, 239)"],
    *[style*="rgb(236, 72, 153)"] {
        color: #26A17B !important;
        background-color: #26A17B !important;
        border-color: #26A17B !important;
    }
    
    /* Заменяем фиолетовые цвета в тексте */
    h1, h2, h3, h4, h5, h6,
    p, span, div, a,
    [class*="text-primary"],
    [class*="text-purple"],
    [class*="text-violet"] {
        color: inherit !important;
    }
    
    /* Принудительно заменяем фиолетовый цвет в заголовках */
    h1[style*="purple"],
    h2[style*="purple"],
    h3[style*="purple"],
    h1[style*="violet"],
    h2[style*="violet"],
    h3[style*="violet"],
    h1[style*="#667eea"],
    h2[style*="#667eea"],
    h3[style*="#667eea"] {
        color: #26A17B !important;
    }
    
    .btn-primary,
    .button-primary,
    input[type="submit"].default,
    .submit-row input[type="submit"],
    input[type="submit"],
    button[type="submit"] {
        background-color: #26A17B !important;
        border-color: #26A17B !important;
        color: white !important;
    }
    
    .btn-primary:hover,
    .button-primary:hover,
    input[type="submit"].default:hover,
    .submit-row input[type="submit"]:hover {
        background-color: #1d7a5d !important;
        border-color: #1d7a5d !important;
    }
    
    /* Принудительно заменяем фиолетовые цвета в кнопках */
    .btn-primary,
    .button-primary,
    input[type="submit"],
    button[type="submit"],
    .btn-primary:focus,
    .button-primary:focus,
    input[type="submit"]:focus,
    button[type="submit"]:focus,
    .btn-primary:active,
    .button-primary:active,
    input[type="submit"]:active,
    button[type="submit"]:active,
    .btn-primary:hover,
    .button-primary:hover,
    input[type="submit"]:hover,
    button[type="submit"]:hover {
        background-color: #26A17B !important;
        background: #26A17B !important;
        background-image: none !important;
        border-color: #26A17B !important;
        color: white !important;
    }
    
    /* Принудительно заменяем фиолетовые цвета в фокусе инпутов */
    .form-control:focus,
    input[type="text"]:focus,
    input[type="password"]:focus,
    input[type="email"]:focus,
    textarea:focus,
    select:focus {
        border-color: #26A17B !important;
        box-shadow: 0 0 0 3px rgba(38, 161, 123, 0.1) !important;
        outline-color: #26A17B !important;
    }
    
    /* Убираем фиолетовые цвета из всех возможных состояний */
    *:focus {
        outline-color: #26A17B !important;
    }
    
    *[style*="purple"]:focus,
    *[style*="violet"]:focus,
    *[style*="#667eea"]:focus,
    *[style*="#764ba2"]:focus {
        border-color: #26A17B !important;
        box-shadow: 0 0 0 3px rgba(38, 161, 123, 0.1) !important;
    }
    
    /* Скрываем кнопку "Return to site" - все возможные варианты */
    .login-page a[href="/"],
    .login-page a[href*="/"]:not([href*="/admin/"]):not([href*="login"]):not([href*="logout"]),
    .login-page .site-link,
    .login-page .return-link,
    .login-page header a[href="/"],
    .login-page [class*="return"],
    .login-page [class*="site-link"],
    body.login-page a[href="/"],
    body.login-page header a[href="/"],
    /* Скрываем все ссылки с текстом Return */
    a:contains("Return"),
    a:contains("return"),
    a:contains("←") {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        width: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
        position: absolute !important;
        left: -9999px !important;
        pointer-events: none !important;
    }
    
    /* Темная тема - белый текст для "Welcome back to" */
    [data-theme="dark"] .login-page,
    html[data-theme="dark"] .login-page {
        background: #0E1829 !important;
    }
    
    [data-theme="dark"] .login-page label,
    html[data-theme="dark"] .login-page label,
    [data-theme="dark"] .login-page p,
    html[data-theme="dark"] .login-page p,
    [data-theme="dark"] .login-page h1,
    html[data-theme="dark"] .login-page h1,
    [data-theme="dark"] .login-page h2,
    html[data-theme="dark"] .login-page h2,
    [data-theme="dark"] .login-page h3,
    html[data-theme="dark"] .login-page h3,
    [data-theme="dark"] .login-page .login-box-msg,
    html[data-theme="dark"] .login-page .login-box-msg {
        color: white !important;
    }
    
    /* Иконки переключателя темы - белые при темной теме */
    [data-theme="dark"] .theme-toggle svg,
    html[data-theme="dark"] .theme-toggle svg,
    [data-theme="dark"] .theme-toggle,
    html[data-theme="dark"] .theme-toggle,
    [data-theme="dark"] button[aria-label*="theme"] svg,
    html[data-theme="dark"] button[aria-label*="theme"] svg,
    [data-theme="dark"] [class*="theme"] svg,
    html[data-theme="dark"] [class*="theme"] svg,
    [data-theme="dark"] .theme-toggle path,
    html[data-theme="dark"] .theme-toggle path,
    [data-theme="dark"] .theme-toggle circle,
    html[data-theme="dark"] .theme-toggle circle,
    [data-theme="dark"] .theme-toggle *,
    html[data-theme="dark"] .theme-toggle * {
        color: white !important;
        fill: white !important;
        stroke: white !important;
    }
    
    /* Светлая тема - черные лейблы и текст инпутов */
    [data-theme="light"] .login-page label,
    html[data-theme="light"] .login-page label,
    html:not([data-theme="dark"]) .login-page label {
        color: #000 !important;
    }
    
    [data-theme="light"] .login-page .form-control,
    html[data-theme="light"] .login-page .form-control,
    html:not([data-theme="dark"]) .login-page .form-control {
        background-color: white !important;
        border: 1px solid #ddd !important;
        color: #000 !important;
    }
    
    [data-theme="light"] .login-page .form-control:focus,
    html[data-theme="light"] .login-page .form-control:focus,
    html:not([data-theme="dark"]) .login-page .form-control:focus {
        background-color: white !important;
        border-color: #26A17B !important;
        color: #000 !important;
        box-shadow: 0 0 0 3px rgba(38, 161, 123, 0.1) !important;
    }
    
    /* Скрываем логотип на странице входа - все возможные варианты */
    .login-page img,
    .login-page img[src*="logo"],
    .login-page img[src*="Logo"],
    .login-page [class*="logo"] img,
    .login-page [class*="brand"] img,
    .login-page header img,
    .login-page .unfold-header img,
    .login-page .login-box-msg img,
    .login-page .brand-image,
    /* Скрываем элементы с Tailwind классами */
    .login-page .bg-cover,
    .login-page [class*="bg-cover"],
    .login-page [class*="grow"],
    .login-page [class*="max-w-3xl"],
    .login-page [class*="xl:max-w-4xl"],
    .login-page [class*="xl:block"],
    /* Скрываем все элементы с этими классами вместе */
    .login-page .bg-cover.grow,
    .login-page .bg-cover.hidden,
    .login-page .bg-cover.max-w-3xl,
    .login-page [class*="bg-cover"][class*="grow"],
    .login-page [class*="bg-cover"][class*="hidden"],
    .login-page [class*="bg-cover"][class*="max-w-3xl"],
    .login-page [class*="bg-cover"][class*="xl:max-w-4xl"],
    .login-page [class*="bg-cover"][class*="xl:block"],
    /* Скрываем все div с этими классами */
    .login-page div[class*="bg-cover"],
    .login-page div[class*="grow"],
    .login-page div[class*="max-w-3xl"],
    .login-page div[class*="xl:max-w-4xl"],
    .login-page div[class*="xl:block"],
    /* Скрываем все элементы на странице входа с этими классами */
    body.login-page [class*="bg-cover"],
    body.login-page [class*="grow"][class*="bg-cover"],
    body.login-page [class*="max-w-3xl"][class*="bg-cover"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        width: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
        position: absolute !important;
        left: -9999px !important;
    }
    
    /* Переопределяем xl:block для скрытия на всех размерах экрана */
    @media (min-width: 1280px) {
        .login-page .bg-cover,
        .login-page [class*="bg-cover"],
        .login-page [class*="xl:block"],
        body.login-page [class*="bg-cover"],
        body.login-page [class*="xl:block"] {
            display: none !important;
        }
    }
</style>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script>
    // Удаляем логотип со страницы входа
    (function() {
        function removeLogo() {
            // Ищем все элементы с классами bg-cover, grow, max-w-3xl, xl:max-w-4xl, xl:block
            const logoElements = document.querySelectorAll(
                '.bg-cover, [class*="bg-cover"], [class*="grow"], [class*="max-w-3xl"], [class*="xl:max-w-4xl"], [class*="xl:block"]'
            );
            logoElements.forEach(el => {
                // Проверяем, содержит ли элемент классы bg-cover и grow
                if (el.classList.contains('bg-cover') || 
                    el.className.includes('bg-cover') || 
                    (el.className.includes('grow') && el.className.includes('bg-cover'))) {
                    el.style.display = 'none';
                    el.style.visibility = 'hidden';
                    el.style.opacity = '0';
                    el.style.width = '0';
                    el.style.height = '0';
                    el.style.overflow = 'hidden';
                    el.remove();
                }
            });
            
            // Удаляем все изображения логотипа
            const images = document.querySelectorAll('img[src*="logo"], img[src*="Logo"]');
            images.forEach(img => {
                img.remove();
            });
            
            // Удаляем элементы с классом brand-image
            const brandImages = document.querySelectorAll('.brand-image, [class*="brand-image"]');
            brandImages.forEach(el => {
                el.remove();
            });
        }
        
        // Применяем сразу
        removeLogo();
        
        // Применяем после загрузки DOM
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', removeLogo);
        } else {
            removeLogo();
        }
        
        // Применяем после полной загрузки
        window.addEventListener('load', function() {
            setTimeout(removeLogo, 100);
            setTimeout(removeLogo, 500);
        });
        
        // Наблюдаем за изменениями DOM
        const observer = new MutationObserver(function(mutations) {
            removeLogo();
            replacePurpleColors();
        });
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true
        });
        
        // Функция для замены фиолетовых цветов на зеленый
        function replacePurpleColors() {
            // Заменяем цвета в кнопках
            const buttons = document.querySelectorAll('button, input[type="submit"], .btn-primary, .button-primary');
            buttons.forEach(btn => {
                const style = window.getComputedStyle(btn);
                const bgColor = style.backgroundColor;
                const borderColor = style.borderColor;
                
                // Проверяем, если цвет фиолетовый
                if (bgColor.includes('rgb(102, 126, 234)') || 
                    bgColor.includes('rgb(118, 75, 162)') ||
                    bgColor.includes('rgb(139, 92, 246)') ||
                    bgColor.includes('rgb(147, 51, 234)') ||
                    bgColor.includes('#667eea') ||
                    bgColor.includes('#764ba2') ||
                    bgColor.includes('#6f42c1') ||
                    bgColor.includes('#7c3aed')) {
                    btn.style.backgroundColor = '#26A17B';
                    btn.style.background = '#26A17B';
                    btn.style.backgroundImage = 'none';
                }
                
                if (borderColor.includes('rgb(102, 126, 234)') || 
                    borderColor.includes('rgb(118, 75, 162)') ||
                    borderColor.includes('#667eea') ||
                    borderColor.includes('#764ba2')) {
                    btn.style.borderColor = '#26A17B';
                }
            });
            
            // Заменяем цвета в фокусе инпутов
            const inputs = document.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.borderColor = '#26A17B';
                    this.style.boxShadow = '0 0 0 3px rgba(38, 161, 123, 0.1)';
                    this.style.outlineColor = '#26A17B';
                });
            });
        }
        
        // Применяем замену цветов
        replacePurpleColors();
        
        // Применяем после загрузки
        window.addEventListener('load', function() {
            setTimeout(replacePurpleColors, 100);
            setTimeout(replacePurpleColors, 500);
        });
        
        // Удаляем кнопку "Return to site"
        function removeReturnButton() {
            const returnButtons = document.querySelectorAll('a[href="/"], a:has-text("Return"), a:has-text("return"), a:has-text("←")');
            returnButtons.forEach(btn => {
                if (btn.textContent && (btn.textContent.includes('Return') || btn.textContent.includes('return') || btn.textContent.includes('←'))) {
                    btn.style.display = 'none';
                    btn.style.visibility = 'hidden';
                    btn.remove();
                }
            });
        }
        
        // Переводим "Welcome back to" на русский и делаем белым при темной теме - агрессивно
        function translateWelcomeText() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark' || 
                          document.documentElement.classList.contains('dark') ||
                          document.body.classList.contains('dark');
            
            const welcomeTexts = document.querySelectorAll('p, h1, h2, h3, span, div, label, *');
            welcomeTexts.forEach(el => {
                if (el.textContent || el.innerText) {
                    const text = el.textContent || el.innerText;
                    
                    // Переводим текст
                    if (text.includes('Welcome back to')) {
                        el.textContent = text.replace(/Welcome back to/gi, 'Добро пожаловать в');
                        el.innerText = text.replace(/Welcome back to/gi, 'Добро пожаловать в');
                    }
                    
                    // Делаем белым при темной теме
                    if (isDark && (text.includes('Добро пожаловать в') || text.includes('Welcome'))) {
                        el.style.setProperty('color', 'white', 'important');
                    }
                }
            });
        }
        
        // Исправляем цвета лейблов и инпутов - агрессивно
        function fixInputColors() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark' || 
                          document.documentElement.classList.contains('dark') ||
                          document.body.classList.contains('dark');
            
            // Исправляем лейблы
            const labels = document.querySelectorAll('label, .form-group label, [for]');
            labels.forEach(label => {
                if (isDark) {
                    label.style.setProperty('color', 'white', 'important');
                } else {
                    label.style.setProperty('color', '#000', 'important');
                    label.style.setProperty('color', 'black', 'important');
                }
            });
            
            // Исправляем инпуты
            const inputs = document.querySelectorAll('input[type="text"], input[type="password"], input[type="email"], .form-control');
            inputs.forEach(input => {
                if (isDark) {
                    input.style.setProperty('color', 'white', 'important');
                    input.style.setProperty('background-color', '#2d3136', 'important');
                } else {
                    input.style.setProperty('color', '#000', 'important');
                    input.style.setProperty('color', 'black', 'important');
                    input.style.setProperty('background-color', 'white', 'important');
                }
            });
        }
        
        // Исправляем иконки переключателя темы - агрессивно
        function fixThemeToggleIcons() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark' || 
                          document.documentElement.classList.contains('dark') ||
                          document.body.classList.contains('dark');
            
            if (isDark) {
                const themeToggles = document.querySelectorAll('.theme-toggle, button[aria-label*="theme"], [class*="theme"], [id*="theme"]');
                themeToggles.forEach(toggle => {
                    toggle.style.setProperty('color', 'white', 'important');
                    const svgs = toggle.querySelectorAll('svg, path, circle, line, polyline');
                    svgs.forEach(svg => {
                        svg.style.setProperty('color', 'white', 'important');
                        svg.setAttribute('fill', 'white');
                        svg.setAttribute('stroke', 'white');
                        const paths = svg.querySelectorAll('path, circle, line, polyline');
                        paths.forEach(path => {
                            path.setAttribute('fill', 'white');
                            path.setAttribute('stroke', 'white');
                            path.style.setProperty('fill', 'white', 'important');
                            path.style.setProperty('stroke', 'white', 'important');
                        });
                    });
                });
            }
        }
        
        // Применяем все функции
        function applyAllFixes() {
            removeReturnButton();
            translateWelcomeText();
            fixInputColors();
            fixThemeToggleIcons();
        }
        
        // Применяем сразу
        applyAllFixes();
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', applyAllFixes);
        }
        
        window.addEventListener('load', function() {
            setTimeout(applyAllFixes, 100);
            setTimeout(applyAllFixes, 500);
            setTimeout(applyAllFixes, 1000);
        });
        
        // Наблюдаем за изменениями
        const fixObserver = new MutationObserver(function(mutations) {
            applyAllFixes();
        });
        fixObserver.observe(document.body, {
            childList: true,
            subtree: true,
            characterData: true,
            attributes: true,
            attributeFilter: ['data-theme', 'class']
        });
    })();
</script>
{% endblock %}
